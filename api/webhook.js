// Fixes an error with Promise cancellation
process.env.NTBA_FIX_319 = 'test'
const TOKEN = process.env.TOKEN

const TelegramBot = require('node-telegram-bot-api')
const questions = require('./questions')

// Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐµÐ¼ ÑÐºÐ·ÐµÐ¼Ð¿Ð»ÑÑ€ Ð±Ð¾Ñ‚Ð° Ð½Ð° Ð²ÐµÑ€Ñ…Ð½ÐµÐ¼ ÑƒÑ€Ð¾Ð²Ð½Ðµ
const bot = new TelegramBot(TOKEN)

let messageIds = new Map()
const botUsername = 'tetris_dusha_bot'

// Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸, ÑÐ²Ð»ÑÐµÑ‚ÑÑ Ð»Ð¸ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð¾Ð¹
function isCommand(text) {
	const commands = [
		'/q',
		`/q@${botUsername}`,
		'/rules',
		`/rules@${botUsername}`,
		'/stop11',
		`/stop11@${botUsername}`,
		'/stop10',
		`/stop10@${botUsername}`,
	]
	return commands.includes(text)
}

function addMessageId(chatId, messageId) {
	messageIds.set(chatId, messageId)
}

function deletePreviousMessages(chatId, bot) {
	if (messageIds.has(chatId)) {
		const messageId = messageIds.get(chatId)
		bot
			.deleteMessage(chatId, messageId)
			.catch(error => console.error('Error deleting message', error.toString()))
		messageIds.delete(chatId) // Ð£Ð´Ð°Ð»Ð¸Ñ‚Ðµ ID Ð¸Ð· Map Ð¿Ð¾ÑÐ»Ðµ ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ
	}
}

const stop10Message = `ðŸ›‘ **10 Ð¨ÐÐ“ - ÐžÐ¡Ð¢ÐÐÐžÐ’Ð˜Ð¡Ð¬!**

âœ… [Ð¡Ð”Ð•Ð›ÐÐ™ Ð ÐÐ—Ð‘ÐžÐ ](https://t.me/+3uwmhEs5IR42YzFi)

Ð’ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒ Ñ‚ÐµÐ±Ðµ Ñ‡Ð°Ñ‚ Ð¿Ð¾ Ñ€Ð°Ð·Ð±Ð¾Ñ€Ñƒ Ñ Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ð°Ð¼Ð¸ 10 ÑˆÐ°Ð³Ð° Ð“Ñ€ÑƒÐ¿Ð¿Ñ‹ Ð”ÑƒÑˆÐ°. ðŸ«¶ðŸ½

Ð¢Ñ‹ Ð¼Ð¾Ð¶ÐµÑˆÑŒ ÑÐ´ÐµÐ»Ð°Ñ‚ÑŒ ÑÐ²Ð¾Ð¹ Ñ€Ð°Ð·Ð±Ð¾Ñ€ Ð² ÑÑ‚Ð¾Ð¼ Ñ‡Ð°Ñ‚Ðµ Ð¸/Ð¸Ð»Ð¸ Ð¿Ð¾Ð´ÐµÐ»Ð¸Ñ‚ÑŒÑÑ ÑÐ²Ð¾Ð¸Ð¼ Ð¾Ð¿Ñ‹Ñ‚Ð¾Ð¼ Ñ Ð´Ñ€ÑƒÐ³Ð¸Ð¼Ð¸. 
Ð¢Ð²Ð¾Ð¹ Ð¾Ð¿Ñ‹Ñ‚ Ð¾Ñ‡ÐµÐ½ÑŒ Ð²Ð°Ð¶ÐµÐ½ ðŸ«¶ðŸ½

ðŸ“Œ *10 Ð¨ÐÐ“ Ð¿Ñ€ÐµÐ´Ð»Ð°Ð³Ð°ÐµÑ‚ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÑƒ Ð½Ð°ÑˆÐµÐ¹ Ð¶Ð¸Ð·Ð½Ð¸ Ñ Ð½Ñ€Ð°Ð²ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ñ… Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¹, Ð´ÐµÐ»Ð°Ñ‚ÑŒ Ð»Ð¸Ñ‡Ð½ÑƒÑŽ Ð¸Ð½Ð²ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð·Ð°Ñ†Ð¸ÑŽ Ð¸ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð°Ñ‚ÑŒ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÑÑ‚ÑŒ Ñ‚Ðµ Ð½Ð¾Ð²Ñ‹Ðµ Ð¾ÑˆÐ¸Ð±ÐºÐ¸, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð¼Ñ‹ Ð´ÐµÐ»Ð°ÐµÐ¼ Ð½Ð° ÑÐ²Ð¾ÐµÐ¼ Ð¿ÑƒÑ‚Ð¸.*

ÐœÑ‹ ÑÑ‚Ð°Ð»Ð¸ Ð¶Ð¸Ñ‚ÑŒ Ð¿Ð¾-Ð½Ð¾Ð²Ð¾Ð¼Ñƒ, ÐºÐ¾Ð³Ð´Ð° Ñ€Ð°Ð·Ð¾Ð±Ñ€Ð°Ð»Ð¸ÑÑŒ Ñ Ð¿Ñ€ÐµÐ³Ñ€ÐµÑˆÐµÐ½Ð¸ÑÐ¼Ð¸ Ð½Ð°ÑˆÐµÐ³Ð¾ Ð¿Ñ€Ð¾ÑˆÐ»Ð¾Ð³Ð¾.
ÐœÑ‹ Ð²Ð¾ÑˆÐ»Ð¸ Ð² Ð¼Ð¸Ñ€ Ð”ÑƒÑ…Ð°. ÐÐ°ÑˆÐ° ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð°Ñ Ð·Ð°Ð´Ð°Ñ‡Ð° - Ñ€Ð°ÑÑ‚Ð¸ Ð² Ð¿Ð¾Ð½Ð¸Ð¼Ð°Ð½Ð¸Ð¸ Ð¸ Ð¿Ð¾Ð²Ñ‹ÑˆÐ°Ñ‚ÑŒ Ð´ÐµÐ¹ÑÑ‚Ð²ÐµÐ½Ð½Ð¾ÑÑ‚ÑŒ Ð½Ð°ÑˆÐ¸Ñ… ÑƒÑÐ¸Ð»Ð¸Ð¹.

Ð­Ñ‚Ð¾ Ð½Ðµ Ð¿Ñ€Ð¸Ñ…Ð¾Ð´Ð¸Ñ‚ Ð·Ð° Ð¾Ð´Ð¸Ð½ Ð´ÐµÐ½ÑŒ.

ÐÑƒÐ¶Ð½Ð¾ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð°Ñ‚ÑŒ ÑÑ‚Ð¾ Ð´ÐµÐ»Ð°Ñ‚ÑŒ Ð²ÑÑŽ Ð¾ÑÑ‚Ð°Ð²ÑˆÑƒÑŽÑÑ Ð¶Ð¸Ð·Ð½ÑŒ.

Ð›ÑŽÐ±Ð¾Ð²ÑŒ Ðº Ð´Ñ€ÑƒÐ³Ð¸Ð¼ Ð¸ Ñ‚ÐµÑ€Ð¿Ð¸Ð¼Ð¾ÑÑ‚ÑŒ â€“ ÑÑ‚Ð¾ Ð½Ð°ÑˆÐµ ÐºÑ€ÐµÐ´Ð¾.

ðŸ¤– /stop10 - ÐÐ°Ð¶Ð¼Ð¸ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ Ð±Ð¾Ñ‚Ð° Ð² Ñ‡Ð°Ñ‚ Ð¸ ÑÐ´ÐµÐ»Ð°Ð¹ Ñ€Ð°Ð·Ð±Ð¾Ñ€

Ð¡ Ð»ÑŽÐ±Ð¾Ð²ÑŒÑŽ, 
Ð“Ñ€ÑƒÐ¿Ð¿Ð° Ð”ÑƒÑˆÐ° â¤ï¸`

const stop11Message = `ðŸ›‘ *11 Ð¨ÐÐ“ - ÐžÐ¡Ð¢ÐÐÐžÐ’Ð˜Ð¡Ð¬!*

âœ… *Ð¢Ð’ÐžÐ˜ Ð”Ð•Ð™Ð¡Ð¢Ð’Ð˜Ð¯:*

1ï¸âƒ£ *Ð’Ð½ÑƒÑ‚Ñ€ÐµÐ½Ð½ÐµÐµ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ:* 
ÐŸÐ°ÑƒÐ·Ð° - Ð²Ð½Ð¸Ð¼Ð°Ð½Ð¸Ðµ Ð²Ð½ÑƒÑ‚Ñ€ÑŒ ÑÐµÐ±Ñ (Ð½Ð°Ð¿Ñ€Ð°Ð²ÑŒ ÑÐ²Ð¾Ð¹ Ð²Ð½ÑƒÑ‚Ñ€ÐµÐ½Ð½Ð¸Ð¹ Ð²Ð·Ð¾Ñ€ Ð¸ ÐºÐ¾Ð½Ñ†ÐµÐ½Ñ‚Ñ€Ð¸Ñ€ÑƒÐ¹ÑÑ Ð² ÑÐ²Ð¾Ð¹ ÑÐµÑ€Ð´ÐµÑ‡Ð½Ñ‹Ð¹ Ñ†ÐµÐ½Ñ‚Ñ€, Ð¿Ñ€ÑÐ¼Ð¾ Ð¿Ð¾ÑÐµÑ€ÐµÐ´Ð¸Ð½Ðµ Ð³Ñ€ÑƒÐ´Ð¸â€¦ Ð½Ðµ ÑÐ¿ÐµÑˆÐ¸â€¦ Ð½Ð°Ñ‰ÑƒÐ¿Ð°Ð¹ Â«Ñ‚Ð¾Ñ‡ÐºÑƒ Ð¾Ð¿Ð¾Ñ€Ñ‹Â», Ñ‚Ð¾ ÐµÑÑ‚ÑŒ, ÐºÐ¾Ð³Ð´Ð° Ñ‚Ñ‹ Ð²ÑÐµÐ¼ Ð²Ð½Ð¸Ð¼Ð°Ð½Ð¸ÐµÐ¼ Ð²Ð½ÑƒÑ‚Ñ€Ð¸ ÑÐµÐ±Ñ)

2ï¸âƒ£ Ð’Ð¾Ð¿Ñ€Ð¾Ñ - Ð¾Ð±Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ðµ Ðº Ð’Ð¡: 
Â«Ð ÐºÐ°Ðº Ð±Ñ‹ Ð¢Ñ‹ Ñ…Ð¾Ñ‚ÐµÐ», Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ñ ÑÐµÐ¹Ñ‡Ð°Ñ Ð¿Ð¾ÑÑ‚ÑƒÐ¿Ð¸Ð»(Ð°)?Â»
(ÑÐ»ÑƒÑˆÐ°Ð¹ ÑÐ²Ð¾ÑŽ ÑÐ¾Ð²ÐµÑÑ‚ÑŒ) 


3ï¸âƒ£ *Ð’Ð½ÐµÑˆÐ½ÐµÐµ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ:* 
ÐŸÐ¾ÑÑ‚ÑƒÐ¿Ð¸Ñ‚ÑŒ Ð¿Ð¾ Ð½Ð¾Ð²Ð¾Ð¼Ñƒ Ð² ÑÐ²Ð¾ÐµÐ¹ Ð¶Ð¸Ð·Ð½Ð¸, Ð¾ÑÐ½Ð¾Ð²Ñ‹Ð²Ð°ÑÑÑŒ Ð½Ð° Ð”ÑƒÑ…Ð¾Ð²Ð½Ñ‹Ñ… Ð¿Ñ€Ð¸Ð½Ñ†Ð¸Ð¿Ð°Ñ….

4ï¸âƒ£ Ð•ÑÐ»Ð¸ ÐµÑÑ‚ÑŒ ÑÐ¾Ð¼Ð½ÐµÐ½Ð¸Ñ, Ð¾Ð±Ñ€Ð°Ñ‚Ð¸ÑÑŒ Ð·Ð° Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Ð¸ Ð¿Ñ€Ð¸Ð¼Ð¸ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒ** (ÑÐ¿Ð¾Ð½ÑÐ¾Ñ€, Ð´Ð¾Ð²ÐµÑ€ÐµÐ½Ð½Ñ‹Ð¹, Ð²Ñ‹Ð¹Ñ‚Ð¸ Ð½Ð° Ð³Ñ€ÑƒÐ¿Ð¿Ñƒ, Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¸Ñ‚ÑŒ Ð¾Ð±Ñ€Ð°Ñ‚Ð½ÑƒÑŽ ÑÐ²ÑÐ·ÑŒ)

ðŸ“Œ *Ð’ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒ Ñ‚ÐµÐ±Ðµ.*

â‡ï¸ *Ð’Ð½ÑƒÑ‚Ñ€ÐµÐ½Ð½Ð¸Ðµ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ:* 
Ð’ Ñ‚ÐµÑ‡ÐµÐ½Ð¸Ðµ Ð´Ð½Ñ, Ð¾ÑÐ¾Ð±ÐµÐ½Ð½Ð¾, ÐµÑÐ»Ð¸ Ð½Ðµ Ð·Ð½Ð°ÐµÑˆÑŒ, ÐºÐ°Ðº Ð¿Ð¾ÑÑ‚ÑƒÐ¿Ð¸Ñ‚ÑŒ, Ð¾Ð±Ñ€Ð°Ñ‰Ð°Ð¹ÑÑ Ðº Ð’Ð¡ Ð²Ð½ÑƒÑ‚Ñ€ÑŒ ÑÐµÐ±Ñ Ñ Ð¿Ñ€Ð¾ÑÑŒÐ±Ð¾Ð¹ Ð¿Ð¾Ð´ÑÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½ÑƒÑŽ Ð¼Ñ‹ÑÐ»ÑŒ Ð¸ Ñ€ÐµÑˆÐµÐ½Ð¸Ðµ.

â™»ï¸ *Ð’Ð½ÐµÑˆÐ½Ð¸Ðµ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ:* 
Ð’ Ñ‚ÐµÑ‡ÐµÐ½Ð¸Ðµ Ð´Ð½Ñ ÑÑ‚Ð°Ñ€Ð°Ñ‚ÑŒÑÑ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÑÑ‚ÑŒ Ð½Ð¾Ð²Ñ‹Ðµ Ð¿Ñ€Ð¸Ð½Ñ†Ð¸Ð¿Ñ‹ Ð¶Ð¸Ð·Ð½Ð¸ Ð²Ð¾ Ð²ÑÐµÑ… ÑÐ²Ð¾Ð¸Ñ… Ð´ÐµÐ»Ð°Ñ…, Ð¿Ñ€Ð¾ÑÐ¸Ñ‚ÑŒ Ð¸ Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°Ñ‚ÑŒ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒ.

âš ï¸ ÐœÑ‹ Ð¿Ð¾ÑÑ‚Ð¾ÑÐ½Ð½Ð¾ Ð½Ð°Ð¿Ð¾Ð¼Ð¸Ð½Ð°ÐµÐ¼ ÑÐµÐ±Ðµ, Ñ‡Ñ‚Ð¾ Ð¼Ñ‹ Ð±Ð¾Ð»ÑŒÑˆÐµ Ð½Ðµ Ð¼Ð½Ð¸Ð¼ ÑÐµÐ±Ñ Ñ†ÐµÐ½Ñ‚Ñ€Ð¾Ð¼ Ð²ÑÐµÐ»ÐµÐ½Ð½Ð¾Ð¹, ÑÐ¼Ð¸Ñ€ÐµÐ½Ð½Ð¾ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€ÑÑ ÐºÐ°Ð¶Ð´Ñ‹Ð¹ Ð´ÐµÐ½ÑŒ: â€œÐ”Ð° Ð¸ÑÐ¿Ð¾Ð»Ð½ÑŽ Ñ Ð²Ð¾Ð»ÑŽ Ð¢Ð²Ð¾ÑŽâ€. ÐžÑ‚ ÑÑ‚Ð¾Ð³Ð¾ ÑƒÐ¼ÐµÐ½ÑŒÑˆÐ°ÐµÑ‚ÑÑ Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ Ð²Ð¾Ð·Ð½Ð¸ÐºÐ½Ð¾Ð²ÐµÐ½Ð¸Ñ Ð²Ð¾Ð»Ð½ÐµÐ½Ð¸Ð¹, ÑÑ‚Ñ€Ð°Ñ…Ð°, Ð·Ð»Ð¾Ð±Ñ‹, Ð±ÐµÑÐ¿Ð¾ÐºÐ¾Ð¹ÑÑ‚Ð²Ð°, Ð¶Ð°Ð»Ð¾ÑÑ‚Ð¸ Ðº ÑÐµÐ±Ðµ Ð¸ ÑÐ¾Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ Ð½ÐµÐ¾Ð±Ð´ÑƒÐ¼Ð°Ð½Ð½Ñ‹Ñ… Ð¿Ð¾ÑÑ‚ÑƒÐ¿ÐºÐ¾Ð². ÐœÑ‹ ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ð¼ÑÑ Ð³Ð¾Ñ€Ð°Ð·Ð´Ð¾ Ð±Ð¾Ð»ÐµÐµ ÑƒÐ¼ÐµÐ»Ñ‹Ð¼Ð¸. ÐœÑ‹ Ð½Ðµ Ñ‚Ð°Ðº Ð»ÐµÐ³ÐºÐ¾ ÑƒÑ‚Ð¾Ð¼Ð»ÑÐµÐ¼ÑÑ, Ð¿Ð¾Ñ‚Ð¾Ð¼Ñƒ Ñ‡Ñ‚Ð¾ Ð½Ðµ ÑÐ¶Ð¸Ð³Ð°ÐµÐ¼ Ð±ÐµÑÑÐ¼Ñ‹ÑÐ»ÐµÐ½Ð½Ð¾ ÑÐ½ÐµÑ€Ð³Ð¸ÑŽ, ÐºÐ°Ðº ÑÑ‚Ð¾ Ð±Ñ‹Ð»Ð¾ Ñ€Ð°Ð½ÑŒÑˆÐµ, ÐºÐ¾Ð³Ð´Ð° Ð¼Ñ‹ ÑÑ‚Ñ€Ð¾Ð¸Ð»Ð¸ Ð¶Ð¸Ð·Ð½ÑŒ Ñ‚Ð°Ðº, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¾Ð½Ð° ÑƒÑÑ‚Ñ€Ð°Ð¸Ð²Ð°Ð»Ð° Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð½Ð°Ñ.

ðŸ”† Ð’ÐµÐ´ÑŒ Ð‘Ð¾Ð³ (Ð’Ð¡) Ð²ÑÐµÐ³Ð´Ð° Ð±Ñ‹Ð» Ñ€ÑÐ´Ð¾Ð¼, Ð½Ð¾ Ð½Ðµ Ð¼Ð¾Ð³ Ð²Ð¾Ð¹Ñ‚Ð¸ Ð² Ð½Ð°ÑˆÑƒ Ð¶Ð¸Ð·Ð½ÑŒ Ð¿Ð¾Ñ‚Ð¾Ð¼Ñƒ, Ñ‡Ñ‚Ð¾ Ð¼Ñ‹ Ð½Ðµ Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÐ»Ð¸ ÐµÐ¼Ñƒ. Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð¼Ñ‹ ÑÐ¾Ð²ÐµÑ€ÑˆÐ°ÐµÐ¼ ÐµÐ¶ÐµÐ´Ð½ÐµÐ²Ð½Ñ‹Ðµ Ð¿Ñ€Ð¾ÑÑ‚Ñ‹Ðµ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¿Ð¾Ð·Ð²Ð¾Ð»Ð¸Ñ‚ÑŒ.

ðŸ›œ Â«Ð˜ ÐÐ±Ð¾Ð½ÐµÐ½Ñ‚ ÑÐ½Ð¾Ð²Ð° Ð½Ð°Ñ…Ð¾Ð´Ð¸Ñ‚ÑÑ Ð² Ð·Ð¾Ð½Ðµ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ ÑÐµÑ‚Ð¸!Â» ÐÐœÐ˜ÐÐ¬!

ðŸ¤– /stop11 - ÐÐ°Ð¶Ð¼Ð¸ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ Ð±Ð¾Ñ‚Ð° Ð² Ñ‡Ð°Ñ‚ Ð¸ Ð¾Ð±Ñ€Ð°Ñ‚Ð¸ÑÑŒ Ðº Ð’Ð¡   

Ð¡ Ð»ÑŽÐ±Ð¾Ð²ÑŒÑŽ, 
Ð“Ñ€ÑƒÐ¿Ð¿Ð° Ð”ÑƒÑˆÐ° â¤ï¸`

const rulesMessage = `â—ï¸ÐŸÐ ÐÐ’Ð˜Ð›Ð Ð§ÐÐ¢Ð â—ï¸

Ð§Ð°Ñ‚ ÑÐ¾Ð·Ð´Ð°Ð½ Ð´Ð»Ñ Ð¾Ð±Ð¼ÐµÐ½Ð° Ð¾Ð¿Ñ‹Ñ‚Ð¾Ð¼ Ð¿Ð¾ Ñ€Ð°Ð·Ð±Ð¾Ñ€Ñƒ 10 ÑˆÐ°Ð³Ð° Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ñ‹ Â«12 ÑˆÐ°Ð³Ð¾Ð²Â» ÑƒÑ‡Ð°ÑÑ‚Ð½Ð¸ÐºÐ¾Ð² Ð“Ñ€ÑƒÐ¿Ð¿Ñ‹ Ð”ÑƒÑˆÐ°.

âœ…  Ð Ð°Ð·Ñ€ÐµÑˆÐµÐ½Ð¾: 
1. Ð´ÐµÐ»Ð¸Ñ‚ÑŒÑÑ Ð»Ð¸Ñ‡Ð½Ñ‹Ð¼ Ð¾Ð¿Ñ‹Ñ‚Ð¾Ð¼ Ñ€Ð°Ð·Ð±Ð¾Ñ€Ð° Ð¿Ð¾ 10 ÑˆÐ°Ð³Ñƒ
2. Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¸Ñ‚ÑŒ Ð¾Ð¿Ñ‹Ñ‚ 10 ÑˆÐ°Ð³Ð° Ð½Ð° ÑÐ¸Ñ‚ÑƒÐ°Ñ†Ð¸ÑŽ 
3. Ð¿Ð¾Ð´ÐµÐ»Ð¸Ñ‚ÑŒÑÑ Ð»Ð¸Ñ‡Ð½Ñ‹Ð¼ Ð¾Ð¿Ñ‹Ñ‚Ð¾Ð¼ Ð¿Ð¾ Ð·Ð°Ð¿Ñ€Ð¾ÑÑƒ 

âŒ Ð—Ð°Ð¿Ñ€ÐµÑ‰ÐµÐ½Ð¾: 
1. Ð¿ÐµÑ€ÐµÐ¿Ð¸ÑÑ‹Ð²Ð°Ñ‚ÑŒÑÑ 
2. ÐºÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ñ‡ÐµÐ¹-Ð»Ð¸Ð±Ð¾ Ð¾Ð¿Ñ‹Ñ‚
3. ÐºÑ€Ð¸Ñ‚Ð¸ÐºÐ¾Ð²Ð°Ñ‚ÑŒ Ð¸ Ð´Ð°Ð²Ð°Ñ‚ÑŒ Ð¾Ñ†ÐµÐ½ÐºÑƒ

â“ Ð’Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ð’Ñ‹ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ð·Ð°Ð´Ð°Ð²Ð°Ñ‚ÑŒ Ð² Ð»Ð¸Ñ‡Ð½Ñ‹Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð°Ð²Ñ‚Ð¾Ñ€Ð° ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹.

âš ï¸ Ð›ÑŽÐ±Ð°Ñ Ð¿ÐµÑ€ÐµÐ¿Ð¸ÑÐºÐ° Ð±ÑƒÐ´ÐµÑ‚ ÑƒÐ´Ð°Ð»ÐµÐ½Ð° Ð°Ð´Ð¼Ð¸Ð½Ð¾Ð¼ Ñ‡Ð°Ñ‚Ð°. 
ÐŸÑ€Ð¾ÑÑŒÐ±Ð° Ð½Ðµ Ð²Ð¾ÑÐ¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°Ñ‚ÑŒ ÑÑ‚Ð¾, ÐºÐ°Ðº Ð»Ð¸Ñ‡Ð½Ð¾Ðµ Ð¾ÑÐºÐ¾Ñ€Ð±Ð»ÐµÐ½Ð¸Ðµ. 

âš ï¸ ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, ÑÐ¾Ð±Ð»ÑŽÐ´Ð°Ð¹Ñ‚Ðµ Ð¿Ñ€ÐµÐ´Ð½Ð°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð¸ Ñ‡Ð¸ÑÑ‚Ð¾Ñ‚Ñƒ Ñ‡Ð°Ñ‚Ð°. 
Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ ðŸ™ðŸ¼ 

Ð’Ð¾Ð·ÑŒÐ¼Ð¸Ñ‚Ðµ Ñ‚Ð¾, Ñ‡Ñ‚Ð¾ Ð²Ð°Ð¼ Ð¿Ð¾Ð´Ñ…Ð¾Ð´Ð¸Ñ‚ Ð¸ Ð¾Ñ‚Ð±Ñ€Ð¾ÑÑŒÑ‚Ðµ Ð²ÑÑ‘ Ð¾ÑÑ‚Ð°Ð»ÑŒÐ½Ð¾Ðµ â¤ï¸`

module.exports = async (request, response) => {
	try {
		const { body } = request

		if (body.message) {
			const {
				message_id,
				chat: { id },
				text,
			} = body.message

			if (['/stop10', '/stop11'].includes(text)) {
				// Ð¡Ð½Ð°Ñ‡Ð°Ð»Ð° ÑƒÐ´Ð°Ð»ÑÐµÐ¼ Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÐµÐµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ, ÐµÑÐ»Ð¸ Ð¾Ð½Ð¾ ÐµÑÑ‚ÑŒ
				deletePreviousMessages(id, bot)

				// Ð—Ð°Ñ‚ÐµÐ¼ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ð½Ð¾Ð²Ð¾Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ
				const messageToSend = text === '/stop10' ? stop10Message : stop11Message
				await bot
					.sendMessage(id, messageToSend, { parse_mode: 'Markdown' })
					.then(sentMessage => {
						addMessageId(id, sentMessage.message_id) // Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ ID Ð½Ð¾Ð²Ð¾Ð³Ð¾ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ
					})
					.catch(error => console.error('Error sending message', error.toString()))
			}

			if (isCommand(text)) {
				deletePreviousMessages(id, bot)
			}

			// Ð’ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐµ ÐºÐ¾Ð¼Ð°Ð½Ð´
			if (text === '/q' || text === `/q@${botUsername}`) {
				const randomIndex = Math.floor(Math.random() * questions.length)
				const question = questions[randomIndex]
				const message = `ðŸŽˆ Ð’Ð°ÑˆÐ° Ñ‚ÐµÐ¼Ð°: \n\n*"${question}"*`

				await bot
					.sendMessage(id, message, { parse_mode: 'Markdown' })
					.then(sentMessage => {
						addMessageId(id, sentMessage.message_id) // Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ ID ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð±Ð¾Ñ‚Ð°
					})
					.catch(error => console.error('Error sending message', error.toString()))

				// ÐŸÐ¾Ð¿Ñ‹Ñ‚ÐºÐ° ÑƒÐ´Ð°Ð»Ð¸Ñ‚ÑŒ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ñ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð¾Ð¹ /q
				// try {
				//   await bot.deleteMessage(id, message_id)
				// } catch (error) {
				//   console.error('Error deleting message', error.toString())
				// }
			}

			if (text === '/rules' || text === `/rules@${botUsername}`) {
				await bot
					.sendMessage(id, rulesMessage, { parse_mode: 'Markdown' })
					.then(sentMessage => {
						addMessageId(id, sentMessage.message_id) // Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ ID ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð±Ð¾Ñ‚Ð°
					})
					.catch(error => console.error('Error sending message', error.toString()))
			}

			if (text === '/stop10' || text === `/stop10@${botUsername}`) {
				await bot
					.sendMessage(id, stop10Message, {
						parse_mode: 'Markdown',
						disable_web_page_preview: true,
					})
					.then(sentMessage => {
						addMessageId(id, sentMessage.message_id) // Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ ID ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð±Ð¾Ñ‚Ð°
					})
					.catch(error => console.error('Error sending message', error.toString()))
			}

			if (text === '/stop11' || text === `/stop11@${botUsername}`) {
				await bot
					.sendMessage(id, stop11Message, { parse_mode: 'Markdown' })
					.then(sentMessage => {
						addMessageId(id, sentMessage.message_id) // Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ ID ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð±Ð¾Ñ‚Ð°
					})
					.catch(error => console.error('Error sending message', error.toString()))
			}
		}
	} catch (error) {
		console.error('Error in bot operation:', error.toString())
	}

	response.send('OK')
}
